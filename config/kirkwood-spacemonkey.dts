/dts-v1/;

#include "kirkwood.dtsi"
#include "kirkwood-6281.dtsi"

/ {
	model = "Spacemonkey";
	compatible = "marvell,kirkwood-88f6281", "marvell,kirkwood";

	memory {
		device_type = "memory";
		reg = <0x00000000 0x10000000>; // 256 MiB
	};

	chosen {
		bootargs = "console=ttyS0,115200n8 earlyprintk root=/dev/mtdblock2 ro rootfstype=jffs2";
		stdout-path = &uart0;
	};

	ocp@f1000000 {
		pinctrl: pin-controller@10000 {
			pmx_led_orange: pmx-led_orange {
				marvell,pins = "mpp23";
				marvell,function = "gpio";
			};
			pmx_led_green: pmx-led_green {
				marvell,pins = "mpp28";
				marvell,function = "gpio";
			};
			pmx_led_blue: pmx-led_blue { // fan5646
				marvell,pins = "mpp21";
				marvell,function = "gpio";
			};
			pmx_button_func: pmx-button_func {
				marvell,pins = "mpp37";
				marvell,function = "gpio";
			};
			// pmx_usb_power_enable: pmx-usb-power-enable {
			// 	marvell,pins = "mpp29";
			// 	marvell,function = "gpio";
			// };
		};
		serial@12000 {
			status = "ok";
		};

		sata@80000 {
			status = "okay";
			nr-ports = <1>; // changed from <2>
		};

	};
	gpio-leds {
		compatible = "gpio-leds";
		pinctrl-0 = < &pmx_led_orange
			      &pmx_led_green
			      &pmx_led_blue
			    >;
		pinctrl-names = "default";

		misc {
			label = "status:blue:misc";
			gpios = <&gpio0 21 GPIO_ACTIVE_LOW>;
			default-state = "keep";
		};
		health {
			label = "status:green:health";
			gpios = <&gpio0 28 GPIO_ACTIVE_LOW>;
		};
		fault {
			label = "status:orange:fault";
			gpios = <&gpio0 23 GPIO_ACTIVE_LOW>;
		};
	};
	// gpio-keys {
	//     compatible = "gpio-keys";
	// 	pinctrl-0 = < &pmx_button_func >;
	// 	pinctrl-names = "default";

	// 	button@1 {
	// 	    label = "func button";
	// 		gpios = <>
	// 	}
	// };
};

&nand {
	chip-delay = <25>; // TC58NVG1S3ETA00
	status = "okay";

// These are definitely overridded by the command line partitions. What happens if we don't supply those?
	partition@0 {
		label = "u-boot";
		reg = <0x0000000 0x100000>;
		read-only;
	};

	partition@100000 {
		label = "uImage";
		reg = <0x0100000 0x500000>;
	};

	partition@500000 {
		label = "root";
		reg = <0x0500000 0xf00000>;
	};

	partition@f00000 {
		label = "secure";
		reg = <0x0f00000 0x1000000>;
	};

	partition@1000000 {
		label = "data";
		reg = <0x1000000 0x10000000>;
	};
};

&mdio {
	status = "okay";

	ethphy0: ethernet-phy@0 {
		reg = <0>;
	};
};

&eth0 {
	status = "okay";
	ethernet0-port@0 {
		phy-handle = <&ethphy0>;
		local-mac-address = [70 93 f8 00 09 7b];
	};
};
